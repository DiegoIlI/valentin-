<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>üíò Para Ti</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#05060a;
  overflow:hidden;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
canvas{
  position:fixed;
  inset:0;
}
.ui{
  position:fixed;
  top:18px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  background:rgba(10,12,20,.65);
  padding:10px 18px;
  border-radius:999px;
  backdrop-filter:blur(15px);
  color:#fff;
  z-index:5;
}
.ui input{
  border:none;
  background:transparent;
  color:white;
  font-weight:700;
  width:130px;
  outline:none;
}
.ui button{
  background:white;
  color:black;
  border:none;
  border-radius:999px;
  padding:6px 12px;
  font-weight:800;
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div class="ui">
  Para:
  <input id="name" value="Misita‚ù§Ô∏è"/>
  <button onclick="restart()">‚ñ∂</button>
</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let W,H,DPR;
function resize(){
  DPR = Math.min(2, window.devicePixelRatio || 1);
  W = innerWidth;
  H = innerHeight;
  canvas.width = W*DPR;
  canvas.height = H*DPR;
  canvas.style.width = W+"px";
  canvas.style.height = H+"px";
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
resize();
addEventListener("resize",resize);

// ===== MATRIX FONDO =====
let columns = Math.floor(innerWidth/18);
let drops = Array(columns).fill(1);

function drawMatrix(){
  ctx.fillStyle="rgba(5,6,10,.15)";
  ctx.fillRect(0,0,W,H);

  ctx.fillStyle="rgba(255,80,200,.6)";
  ctx.font="16px monospace";

  for(let i=0;i<drops.length;i++){
    let char = String.fromCharCode(0x30A0+Math.random()*96);
    let x=i*18;
    let y=drops[i]*18;
    ctx.fillText(char,x,y);
    if(y>H && Math.random()>0.975) drops[i]=0;
    drops[i]++;
  }
}

// ===== FOTO =====
const img = new Image();
img.src = "foto.jpg"; // CAMBIA ESTO si tu imagen tiene otro nombre

// ===== ESCENAS =====
let scene=0;
let start=0;
let name="Misita‚ù§Ô∏è";
const time=1500;

function restart(){
  name=document.getElementById("name").value||"Mi Amor";
  scene=0;
  start=performance.now();
}

function update(now){
  if(scene<6 && now-start>time){
    scene++;
    start=now;
  }
}

function drawText(text,size,y){
  ctx.save();
  ctx.textAlign="center";
  ctx.textBaseline="middle";
  ctx.font="900 "+size+"px system-ui";
  ctx.fillStyle="white";
  ctx.shadowColor="white";
  ctx.shadowBlur=25;
  ctx.fillText(text,W/2,y);
  ctx.restore();
}

function drawFinalScene(){
  // Dibujar foto centrada
  const imgWidth = W*0.75;
  const imgHeight = imgWidth * 0.7;

  const x = (W - imgWidth)/2;
  const y = (H - imgHeight)/2;

  ctx.drawImage(img, x, y, imgWidth, imgHeight);

  // Nota tipo papel
  const noteWidth = imgWidth*0.85;
  const noteHeight = imgHeight*0.4;
  const nx = W/2 - noteWidth/2;
  const ny = y + imgHeight*0.45;

  ctx.fillStyle="rgba(255,255,255,.95)";
  ctx.shadowColor="rgba(0,0,0,.3)";
  ctx.shadowBlur=15;
  ctx.fillRect(nx,ny,noteWidth,noteHeight);

  ctx.shadowBlur=0;
  ctx.fillStyle="#111";
  ctx.textAlign="center";
  ctx.textBaseline="middle";
  ctx.font="600 18px system-ui";

  const phrase = "Y jam√°s olvides que el brillo tuyo es tan intenso como el de mil soles";
  wrapText(phrase, W/2, ny+noteHeight/2, noteWidth-30, 22);
}

function wrapText(text,x,y,maxWidth,lineHeight){
  const words=text.split(" ");
  let line="";
  let lines=[];

  for(let n=0;n<words.length;n++){
    let testLine=line+words[n]+" ";
    let metrics=ctx.measureText(testLine);
    if(metrics.width>maxWidth && n>0){
      lines.push(line);
      line=words[n]+" ";
    }else{
      line=testLine;
    }
  }
  lines.push(line);

  const totalHeight=lines.length*lineHeight;
  let startY=y-totalHeight/2;

  for(let i=0;i<lines.length;i++){
    ctx.fillText(lines[i],x,startY+(i*lineHeight));
  }
}

function loop(now){
  drawMatrix();
  update(now);

  const big=Math.min(W,H)*0.4;
  const mid=Math.min(W,H)*0.16;

  switch(scene){
    case 0: drawText("1",big,H*0.5); break;
    case 1: drawText("2",big,H*0.5); break;
    case 2: drawText("3",big,H*0.5); break;
    case 3: drawText("You",mid,H*0.4); break;
    case 4: drawText("Are",mid,H*0.5); break;
    case 5: drawText("My Love",mid,H*0.6); break;
    default:
      drawFinalScene();
  }

  requestAnimationFrame(loop);
}

restart();
requestAnimationFrame(loop);
</script>

</body>
</html>
